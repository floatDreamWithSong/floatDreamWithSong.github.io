# 手写编译解释器的零碎笔记

- 扫描（词法分析）：将源代码转换成一个个的词法单元（token）
- 解析词法分析结果生成抽象语法树（语法分析）
- 静态分析
  -` 绑定或决议`:对于每一个标识符，我们都要找出定义该名称的地方，并将两者连接起来。这就是作用域的作用——在这个源代码区域中，某个名字可以用来引用某个声明。如果语言是静态类型的，这就是我们进行类型检查的时机
- 中间码（字节码）（intermediate representation， 也叫IR）
 - 中间码是介于源代码和目标代码之间的代码。它比源代码更接近目标代码，但仍然与具体的机器无关。中间码使得编译器可以生成与机器无关的代码，从而在不同的机器上运行。中间码还可以用于优化和调试。
- 优化中间代码
  - 比如用户输入了一串字面量计算表达式，我们可以直接把结果计算出来放入程序
- 生成目标代码
- 虚拟机
- 运行时
  - GC
  - 反射
- 编译器
  - 单遍编译器
    - 一些简单的编译器将解析、分析和代码生成交织在一起，这样它们就可以直接在解析器中生成输出代码，而无需分配任何语法树或其他IR。比如C和骆驼
    - 你没有中间数据结构来存储程序的全局信息，也不会重新访问任何之前解析过的代码部分。
  - 树遍历解释器
    - 有些编程语言在将代码解析为AST后就开始执行代码（可能应用了一点静态分析）。为了运行程序，解释器每次都会遍历语法树的一个分支和叶子，并在运行过程中计算每个节点。
  - 转译器
    - 转译器将源代码转换为另一种语言的代码，然后使用该语言的编译器或解释器来运行生成的代码。比如TypeScript
  - JIT（Just-In-Time）编译器
    - JIT编译器在运行时将中间代码转换为机器代码。JIT编译器通常用于提高性能，因为它们可以在运行时进行优化，而无需在编译时进行优化。JIT编译器通常用于高性能应用，如游戏和Web浏览器。
  - AOT（Ahead-Of-Time）编译器
    - AOT编译器在编译时将源代码转换为机器代码。AOT编译器通常用于提高性能，因为它们可以在编译时进行优化，而无需在运行时进行优化。AOT编译器通常用于高性能应用，如操作系统和嵌入式系统。

- 动态类型
- 自动内存管理，GC：引用计数和依赖跟踪
- 数据类型
  - 布尔
  - 数字
  - 字符串
- 表达式
  - 算术运算
  - 比较运算
  - 逻辑运算
  - （优先级）
- 语句
- 变量
- 控制流
  - 分支
  - 循环
- 函数
 - 闭包
- 类 or 原型

- 词素和标记（Lexemes and Tokens）:词法单元
- 标记类型
- CFG：上下文无关语法（Context-Free Grammar）
- 表达式类
- Metaprogramming the trees：树形元编程
- 访问者模式
- 递归下降解析器